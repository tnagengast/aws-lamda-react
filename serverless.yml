service: notes-app-api

plugins:
    - serverless-webpack

custom:
    webpackIncludeModules: true

provider:
    name: aws
    runtime: nodejs6.10
    stage: prod
    region: us-west-2
    iamRoleStatements:
      - Effect: Allow
        Action:
            - dynamodb:DescribeTable
            - dynamodb:Query
            - dynamodb:Scan
            - dynamodb:GetItem
            - dynamodb:PutItem
            - dynamodb:UpdateItem
            - dynamodb:DeleteItem
        Resource: "arn:aws:dynamodb:us-west-2:*:*"

functions:
    create:
        handler: main.Note.create
        events:
            - http:
                path: notes
                method: post
                cors: true
                authorizer:
                    arn: arn:aws:cognito-idp:us-west-2:655205504557:userpool/us-west-2_pdeQDEDo4

    get:
        handler: main.Note.get
        events:
            - http:
                path: notes/{id}
                method: get
                cors: true
                authorizer:
                    arn: arn:aws:cognito-idp:us-west-2:655205504557:userpool/us-west-2_pdeQDEDo4

    list:
        handler: main.Note.list
        events:
            - http:
                path: notes
                method: get
                cors: true
                authorizer:
                    arn: arn:aws:cognito-idp:us-west-2:655205504557:userpool/us-west-2_pdeQDEDo4

    update:
        handler: main.Note.update
        events:
            - http:
                path: notes/{id}
                method: put
                cors: true
                authorizer:
                    arn: arn:aws:cognito-idp:us-west-2:655205504557:userpool/us-west-2_pdeQDEDo4

    delete:
        handler: main.Note.delete
        events:
            - http:
                path: notes/{id}
                method: delete
                cors: true
                authorizer:
                    arn: arn:aws:cognito-idp:us-west-2:655205504557:userpool/us-west-2_pdeQDEDo4
